2025-07-06 11:00:11,162 - INFO - 日志将同时输出到控制台和文件: D:\TCM\DA0C.Y\herb_project\outputs\entrez_run_2025-07-06_11-00-11\run.log
2025-07-06 11:00:11,162 - INFO - 本次运行的输出将保存在: D:\TCM\DA0C.Y\herb_project\outputs\entrez_run_2025-07-06_11-00-11
2025-07-06 11:00:11,164 - INFO - 本次运行的模型将保存在: D:\TCM\DA0C.Y\herb_project\models\entrez_run_2025-07-06_11-00-11
2025-07-06 11:00:11,164 - INFO - 接收到 5 个独特的EntrezID，开始查找正样本...
2025-07-06 11:00:11,164 - INFO - 正在从 D:\TCM\D13_InChIKey_EntrezID.tsv 中查找与 5 个EntrezID相关的InChIKey...
2025-07-06 11:00:12,461 - INFO - 成功找到 1243 个独特的InChIKey作为正样本。
2025-07-06 11:00:12,470 - INFO - 正在从本地文件加载SMILES数据: D:\TCM\D12_InChIKey.tsv
2025-07-06 11:00:13,766 - INFO - 成功加载并缓存 123647 条InChIKey-SMILES映射。
2025-07-06 11:00:13,783 - INFO - 从本地文件中，成功为 1243 / 1243 个独立的InChIKey找到SMILES。
2025-07-06 11:00:13,783 - INFO - 步骤完成：确定正样本数量为 1243。
2025-07-06 11:00:13,783 - INFO - 正在加载完整的未标记样本库: D:\TCM\DA0C.Y\yazhou.csv
2025-07-06 11:00:13,866 - INFO - 去除与正样本重复的项后，可用的未标记样本数: 47577
2025-07-06 11:00:13,866 - INFO - 下一步：根据1:10的比例，需要从未标记样本中随机抽取 12430 个。
2025-07-06 11:00:13,892 - INFO - 已成功随机抽取 12430 个未标记样本。
2025-07-06 11:00:13,892 - INFO - 正在合并正样本和抽样后的未标记样本...
2025-07-06 11:00:13,898 - INFO - 最终训练集总样本数: 13673
2025-07-06 11:00:13,898 - INFO - 样本比例 (Positive:Unlabeled) 约为 1:10
2025-07-06 11:00:13,944 - INFO - 已将按比例准备好的训练数据保存到: D:\TCM\DA0C.Y\herb_project\outputs\entrez_run_2025-07-06_11-00-11\prepared_training_data.csv
2025-07-06 11:00:13,944 - INFO - 开始PU-Bagging集成模型训练...
2025-07-06 11:00:18,199 - INFO - 将并行训练 10 个模型...
2025-07-06 11:00:31,024 - ERROR - 在执行过程中发生严重错误: MPNN.__init__() got an unexpected keyword argument 'ffn'
joblib.externals.loky.process_executor._RemoteTraceback: 
"""
Traceback (most recent call last):
  File "D:\anaconda3\envs\herb\Lib\site-packages\joblib\externals\loky\process_executor.py", line 490, in _process_worker
    r = call_item()
        ^^^^^^^^^^^
  File "D:\anaconda3\envs\herb\Lib\site-packages\joblib\externals\loky\process_executor.py", line 291, in __call__
    return self.fn(*self.args, **self.kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\anaconda3\envs\herb\Lib\site-packages\joblib\parallel.py", line 607, in __call__
    return [func(*args, **kwargs) for func, args, kwargs in self.items]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\anaconda3\envs\herb\Lib\site-packages\joblib\parallel.py", line 607, in <listcomp>
    return [func(*args, **kwargs) for func, args, kwargs in self.items]
            ^^^^^^^^^^^^^^^^^^^^^
  File "D:\TCM\DA0C.Y\herb_project\modeling\trainer.py", line 36, in train_single_model
    model = MPNN(
            ^^^^^
TypeError: MPNN.__init__() got an unexpected keyword argument 'ffn'
"""

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\TCM\DA0C.Y\herb_project\main.py", line 82, in main
    trained_models_dir = trainer.train_pu_model_ensemble(training_data_path, config, run_models_dir)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\TCM\DA0C.Y\herb_project\modeling\trainer.py", line 100, in train_pu_model_ensemble
    Parallel(n_jobs=-1)(
  File "D:\anaconda3\envs\herb\Lib\site-packages\joblib\parallel.py", line 2072, in __call__
    return output if self.return_generator else list(output)
                                                ^^^^^^^^^^^^
  File "D:\anaconda3\envs\herb\Lib\site-packages\joblib\parallel.py", line 1682, in _get_outputs
    yield from self._retrieve()
  File "D:\anaconda3\envs\herb\Lib\site-packages\joblib\parallel.py", line 1784, in _retrieve
    self._raise_error_fast()
  File "D:\anaconda3\envs\herb\Lib\site-packages\joblib\parallel.py", line 1859, in _raise_error_fast
    error_job.get_result(self.timeout)
  File "D:\anaconda3\envs\herb\Lib\site-packages\joblib\parallel.py", line 758, in get_result
    return self._return_or_raise()
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "D:\anaconda3\envs\herb\Lib\site-packages\joblib\parallel.py", line 773, in _return_or_raise
    raise self._result
TypeError: MPNN.__init__() got an unexpected keyword argument 'ffn'
2025-07-06 11:00:31,032 - INFO - ===== 流程因错误而终止 =====
